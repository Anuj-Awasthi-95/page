<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Will you be my Valentine?</title>
    <style>
      :root{--bg1:#ffdde1;--bg2:#ee9ca7;--card:#fff;--accent:#e11d48}
      html,body{height:100%}
      body{
        margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
        background:radial-gradient(circle at 10% 10%, rgba(255,255,255,0.15), transparent 10%), linear-gradient(120deg,var(--bg1),var(--bg2));
        display:flex;align-items:center;justify-content:center;overflow:hidden;color:#2b2b2b
      }
      /* background layer for accumulating NO/YES svgs */
      #bgLayer{position:fixed;inset:0;z-index:0;overflow:hidden}
      /* floating hearts */
      .heart{position:absolute;opacity:0.85;width:28px;height:28px;transform:translateY(0);animation:float 6s linear infinite}
      @keyframes float{0%{transform:translateY(0) scale(1)}50%{transform:translateY(-40vh) scale(1.1)}100%{transform:translateY(-80vh) scale(.9);opacity:0}}
      /* center card/envelope */
      .container{z-index:2;display:flex;align-items:center;justify-content:center}
      .envelope{position:relative;overflow:visible;width:320px;cursor:pointer;border-radius:14px;padding:22px;background:linear-gradient(180deg,#fffefe,#fff);box-shadow:0 10px 30px rgba(0,0,0,0.12);text-align:center;transition:transform .25s ease;z-index:3}
      .envelope:hover{transform:translateY(-6px)}
      .title{font-size:1.25rem;margin:0 0 8px 0;color:var(--accent);font-weight:700}
      .subtitle{margin:0;color:#6b7280}
      .card-inner{margin-top:12px}
      .question{font-size:1.25rem;margin:12px 0 0 0}
      .actions{display:flex;gap:12px;justify-content:center;margin-top:14px}
      button{padding:10px 16px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
      .yes{background:var(--accent);color:white}
      .no{background:#f3f4f6;color:#111}
      /* open state */
      .open .envelope{transform:translateY(-10px) scale(1.02)}
      .message{margin-top:12px;font-size:1rem}
      /* subtle confetti/hearts on yes */
      .burst{position:fixed;inset:0;pointer-events:none;z-index:1}
      .hidden{display:none}
      /* background NO images (low-opacity, behind the card) */
      .bg-no{position:absolute;pointer-events:none;z-index:0;will-change:transform,opacity}
      .bg-no img, .bg-yes img{display:block}
      /* YES replacement that falls down */
      .bg-yes{position:absolute;pointer-events:none;z-index:0;animation:fall 5200ms linear forwards}
      @keyframes fall{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(120vh) rotate(60deg);opacity:0}}
      /* sparkle overlay when Yes is clicked */
      .sparkles{position:absolute;inset:0;pointer-events:none;z-index:1000;overflow:visible}
      .sparkles .star{position:absolute;width:12px;height:12px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff,#ffd6e0 40%);box-shadow:0 0 16px rgba(255,210,230,0.95);opacity:0;transform:scale(0.2);will-change:transform,opacity}
      @keyframes sparkle{0%{opacity:0;transform:scale(0.2)}25%{opacity:1;transform:scale(1)}60%{opacity:0.9;transform:scale(0.8)}100%{opacity:0;transform:scale(0.2) translateY(-40px)}}
      /* small responsive tweaks */
      @media (max-width:400px){.envelope{width:90%;padding:18px}}
    </style>
  </head>
  <body>
    <div id="bgLayer" aria-hidden="true"></div>
    <div class="container">
      <div id="proposal" class="envelope" role="button" tabindex="0" aria-pressed="false" aria-label="Open proposal">
        <img src="assets/envelope.svg" alt="envelope" width="72" style="display:block;margin:0 auto 10px;filter:drop-shadow(0 6px 12px rgba(0,0,0,0.08));">
        <div class="title">A little note</div>
        <div class="subtitle">I made this just for you</div>
        <div class="card-inner">
          <div id="closedText" class="question">Tap to open ‚ù§Ô∏è</div>
          <div id="openCard" class="hidden">
            <div class="question">Will you be my Valentine?</div>
            <div class="actions">
              <button id="yesBtn" class="yes">Yes üíñ</button>
              <button id="noBtn" class="no">No üòî</button>
            </div>
            <div id="result" class="message"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="burst" class="burst hidden" aria-hidden="true"></div>

    <script>
      const proposal = document.getElementById('proposal');
      const closedText = document.getElementById('closedText');
      const openCard = document.getElementById('openCard');
      const yesBtn = document.getElementById('yesBtn');
      const noBtn = document.getElementById('noBtn');
      const result = document.getElementById('result');
      const burst = document.getElementById('burst');

      function openProposal(){
        // hide header/title and subtitle to focus on the question
        const titleEl = proposal.querySelector('.title');
        const subtitleEl = proposal.querySelector('.subtitle');
        if(titleEl) titleEl.style.display = 'none';
        if(subtitleEl) subtitleEl.style.display = 'none';
        closedText.classList.add('hidden');
        openCard.classList.remove('hidden');
        proposal.setAttribute('aria-pressed','true');
        proposal.classList.add('open');
        // focus first action for keyboard users
        const firstAction = document.getElementById('yesBtn');
        if(firstAction) firstAction.focus();
      }

      proposal.addEventListener('click',()=>{
        if (openCard.classList.contains('hidden')) openProposal();
      });
      proposal.addEventListener('keydown',e=>{ if(e.key=== 'Enter' || e.key===' ') openProposal(); });

      yesBtn.addEventListener('click',()=>{
        // hide action buttons
        const actions = document.querySelector('#openCard .actions');
        if(actions) actions.style.display = 'none';
        // show message
        result.textContent = 'Yes! I knew it üíñ';
        // sparkle effect over the card
        showSparkles();
        // convert background NOs to YES and let them fall
        convertAllNoToYes();
        launchHearts();
      });
      noBtn.addEventListener('click',()=>{
        result.textContent = "Oh... I'll always care for you.";
        // add two NO images to the background layer (persistent)
        addNoToBackground();
        addNoToBackground();
        addNoToBackground();
        // gentle fade hint
        proposal.style.opacity = '0.95';
      });

      function addNoToBackground(){
        const container = document.getElementById('bgLayer');
        const wrapper = document.createElement('div');
        wrapper.className = 'bg-no';
        const img = document.createElement('img');
        // pick one of the four option_no PNGs at random
        const n = 1 + Math.floor(Math.random()*4);
        img.src = `assets/option_no_${n}.png`;
        img.alt = 'NO';
        // random size and position so they accumulate naturally
        const size = Math.floor(80 + Math.random()*280);
        img.style.width = size + 'px';
        img.style.height = 'auto';
        const left = Math.floor(Math.random()*140 - 20); // allow off-edge
        const top = Math.floor(Math.random()*140 - 20);
        wrapper.style.left = left + '%';
        wrapper.style.top = top + '%';
        wrapper.appendChild(img);
        container.appendChild(wrapper);
      }

      // convert all NOs to YES and let them fall
      function convertAllNoToYes(){
        const container = document.getElementById('bgLayer');
        const nodes = Array.from(container.querySelectorAll('.bg-no'));
        nodes.forEach(node => {
          node.classList.remove('bg-no');
          node.classList.add('bg-yes');
          const img = node.querySelector('img');
          if(img){
            const k = 1 + Math.floor(Math.random()*4);
            img.src = `assets/option_yes_${k}.png`;
          }
          // after fall animation ends remove the element
          node.addEventListener('animationend', () => node.remove(), {once:true});
        });
      }

      // create floating hearts for a short burst
      function launchHearts(){
        burst.classList.remove('hidden');
        for(let i=0;i<25;i++){
          const h = document.createElement('div');
          h.className = 'heart';
          const size = 12 + Math.random()*26;
          h.style.width = size+'px'; h.style.height = size+'px';
          h.style.left = (20 + Math.random()*60)+'%';
          h.style.bottom = '-40px';
          h.style.background = 'radial-gradient(circle at 30% 30%, #fff, transparent 25%), linear-gradient(45deg,#ff6b9a,#ff2d95)';
          h.style.borderRadius = '50% 50% 50% 50% / 60% 60% 40% 40%';
          h.style.transform = 'rotate('+ (Math.random()*40 -20) +'deg)';
          h.style.animationDuration = (4 + Math.random()*4)+'s';
          burst.appendChild(h);
          // remove after animation
          setTimeout(()=>{ h.remove(); },100000);
        }
        // hide burst container after a while
        setTimeout(()=>{ burst.classList.add('hidden'); },200000);
      }

      // create/remove sparkle overlay
      function showSparkles(){
        const proposalEl = document.getElementById('proposal');
        const sparkles = document.createElement('div');
        sparkles.className = 'sparkles';
        // make a number of stars positioned randomly within the proposal card
        const rect = proposalEl.getBoundingClientRect();
        const count = 20;
        for(let i=0;i<count;i++){
          const s = document.createElement('div');
          s.className = 'star';
          const x = Math.random()*100; // percent within card
          const y = Math.random()*100;
          s.style.left = `calc(${x}% - 6px)`;
          s.style.top = `calc(${y}% - 6px)`;
          const dur = 900 + Math.floor(Math.random()*900);
          s.style.animation = `sparkle ${dur}ms ease-out forwards`;
          s.style.animationDelay = Math.floor(Math.random()*400) + 'ms';
          sparkles.appendChild(s);
        }
        // append overlay to proposal container so z-index keeps it above card
        proposalEl.appendChild(sparkles);
        // remove after 4s
        setTimeout(()=>{ sparkles.remove(); },42000);
      }
    </script>
  </body>
</html>